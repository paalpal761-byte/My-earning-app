<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Earning App</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { font-family: sans-serif; text-align: center; background: #f4f4f4; padding: 10px; }
        .card { background: white; margin: 20px auto; padding: 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); max-width: 400px; }
        .btn { background: #28a745; color: white; padding: 12px 20px; border: none; border-radius: 5px; cursor: pointer; width: 100%; font-size: 16px; margin-top: 10px; }
        input { padding: 12px; width: 90%; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
        #recaptcha-container { margin: 10px 0; display: flex; justify-content: center; }
    </style>
</head>
<body>

<div id="login-section">
    <h2>Secure Login</h2>
    <div class="card">
        <input type="text" id="phone" placeholder="+91 9878040621">
        <div id="recaptcha-container"></div>
        <button class="btn" onclick="sendOTP()" id="send-btn">Send OTP</button>
        <div id="otp-div" style="display:none; margin-top:20px;">
            <input type="number" id="otp" placeholder="Enter 6 Digit OTP">
            <button class="btn" style="background:#007bff;" onclick="verifyOTP()">Verify OTP</button>
        </div>
    </div>
</div>

<div id="main-app" style="display:none;">
    <h2>Dashboard</h2>
    <div class="card">
        <p style="font-size: 18px;">Balance: <b>â‚¹<span id="user-balance">0.00</span></b></p>
        <button class="btn" onclick="alert('Feature coming soon!')">Collect Daily Reward</button>
    </div>
</div>

<script>
// Aapke latest screenshot se li gayi sahi configuration
const firebaseConfig = {
  apiKey: "AIzaSyDsvE6KNf0pr8X9f7DR8T735lh3hdl7Vb8",
  authDomain: "my-earning-app-78540.firebaseapp.com",
  databaseURL: "https://my-earning-app-78540-default-rtdb.firebaseio.com",
  projectId: "my-earning-app-78540",
  storageBucket: "my-earning-app-78540.firebasestorage.app",
  messagingSenderId: "646826042515",
  appId: "1:646826042515:web:a68a3bf1c284808e691966",
  measurementId: "G-FTB7N9BYR9"
};

// Firebase initialize karna
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const database = firebase.database();

// Visible reCAPTCHA setup
window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container');

function sendOTP() {
    const phoneNumber = document.getElementById('phone').value;
    if(!phoneNumber.includes('+91')) return alert("Kripya number +91 ke saath daalein");

    auth.signInWithPhoneNumber(phoneNumber, window.recaptchaVerifier)
        .then((result) => {
            window.confirmationResult = result;
            document.getElementById('otp-div').style.display = 'block';
            alert("OTP bhej diya gaya hai!");
        }).catch((err) => {
            alert("Error: " + err.message);
            // Error hone par recaptcha reset karna
            window.recaptchaVerifier.render().then(wid => grecaptcha.reset(wid));
        });
}

function verifyOTP() {
    const code = document.getElementById('otp').value;
    if(code.length !== 6) return alert("6 digit ka OTP daalein");

    confirmationResult.confirm(code).then((result) => {
        document.getElementById('login-section').style.display = 'none';
        document.getElementById('main-app').style.display = 'block';
        
        // User balance load karna
        database.ref('users/' + result.user.uid).on('value', (snap) => {
            const val = snap.val();
            document.getElementById('user-balance').innerText = (val && val.balance ? val.balance : 0).toFixed(2);
        });
    }).catch(() => alert("Galat OTP! Fir se koshish karein."));
}
</script>

</body>
</html>
